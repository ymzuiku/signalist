var O=Object.defineProperty;var S=Object.getOwnPropertySymbols;var w=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var A=(t,n,e)=>n in t?O(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e,E=(t,n)=>{for(var e in n||(n={}))w.call(n,e)&&A(t,e,n[e]);if(S)for(var e of S(n))F.call(n,e)&&A(t,e,n[e]);return t};var I=(t,n)=>{var e={};for(var r in t)w.call(t,r)&&n.indexOf(r)<0&&(e[r]=t[r]);if(t!=null&&S)for(var r of S(t))n.indexOf(r)<0&&F.call(t,r)&&(e[r]=t[r]);return e};var g=[];function f(t){let n=()=>{g.push(n);try{t()}finally{g.pop()}};n()}var m=[];var h=0,P=Number.MAX_SAFE_INTEGER-9e5,J=0;function V(){return h+=1,h>P&&(h=0,J+=1),J+""+h}function y(t){return typeof t=="function"&&t.__signal}function x(t){let n=new Set,e=()=>{let c=g[g.length-1];return c&&n.add(c),e.value};return e.value=t,e.__signal=!0,new Proxy(e,{set:function(c,s,a){if(s==="value"){c.value=a;for(let l of n)l()}return!0}})}function nt(t){let n=()=>(n.value=t(),n.value);return n.value=t(),n.__signal=!0,n}import{useMemo as G,useState as L}from"react";var R={value:!0,className:!0};function T(t,n,e){!t||(n==="children"?t.textContent=e:n==="value"?requestAnimationFrame(()=>{t.value=e}):n==="style"?Object.assign(t.style,e):R[n]?t[n]=e:typeof e=="string"||typeof e=="number"?t.setAttribute(n,e):typeof e=="boolean"?e?t.setAttribute(n,""):t.removeAttribute(n):t[n]=e)}var M=Symbol("signal.element"),D=new Set(["$$typeof","key","ref","_owner","_store","_self","_source","_signal","_signalComponent"]);function N(t){let n=[];for(let e=0;e<t.length;e++)Array.isArray(t[e])?n=n.concat(N(t[e])):n.push(t[e]);return n}var C=t=>{let n=!1;return[N(t).map(r=>y(r)?(n=!0,u(r())):u(r)),n]};function u(t){if(!t||t._signalComponent)return t;let b=t,{props:n,ref:e}=b,r=I(b,["props","ref"]);if(!n||typeof r.type=="function")return t;let c=typeof t.type=="string",s=E({},n),a=[],l,_=null;return Object.keys(n).forEach(i=>{let o=n[i];if(o!=null&&!D.has(i)){if(i==="children")if(Array.isArray(o)){let[p,v]=C(o);v&&a.push(()=>{let[j]=C(o);T(l,i,j.join(""))}),s.children=p;return}else if(y(o)){a.push(()=>{let v=o();T(l,i,v)});let p=o();y(p)?s.children=p():s.children=o()}else s.children=u(o);y(o)&&(a.push(()=>{let p=o();l&&T(l,i,p)}),s[i]=o())}}),f(()=>{a.forEach(i=>i())}),c&&a.length&&(_=i=>{l=i,e&&e(i)}),E({_signalComponent:M,props:s,ref:_||e},r)}import{Fragment as $,jsx as q}from"react/jsx-runtime";function St({each:t,children:n}){let[e,r]=L(t());return G(()=>{f(()=>{r(t())})},m),e&&e.length?u(q($,{children:e.map(n)})):null}import{useMemo as K,useState as z}from"react";function _t({value:t,children:n}){let[e,r]=z(!!t());return K(()=>{typeof t=="function"&&f(()=>{r(t())})},m),e?u(n):null}import{useEffect as B}from"react";function H(t){if(typeof window=="undefined")return;let n=localStorage.getItem(t);if(!!n)try{return JSON.parse(n).j}catch(e){return}}function Q(t,n){typeof window!="undefined"&&localStorage.setItem(t,JSON.stringify({j:n}))}var X=[],d=0;function It(t,n){let e=x(n);return X.push({signal:e,key:t}),f(()=>{let r=e();d&&(d===2&&Q(t,r),d===1&&(d=2))}),e}function Jt(){B(()=>{typeof window!="undefined"&&(d=1,X.forEach(t=>{let n=H(t.key);t.signal.value=n===void 0?t.signal.value:n}))},m)}import{useRef as U}from"react";function Ot(t){return U(x(t)).current}export{m as EmptyArray,St as For,_t as If,nt as computed,g as context,f as effect,y as isSignal,V as safeId,x as signal,u as signalJSX,It as signalStorage,Jt as useInitStorage,Ot as useSignal};
